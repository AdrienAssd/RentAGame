<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RentAGame</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  </head>
	<script>
		window.addEventListener('DOMContentLoaded', async () => {
		  try {
			const res = await fetch('http://localhost:3001/api/profile', {
			  method: 'GET',
			  credentials: 'include'
			});
			const data = await res.json();
	  
			const nav = document.querySelector('nav');
			if (data.loggedIn) {
			  // Si connecté, remplacer bouton connexion par icône profil
			  const profileLink = document.createElement('a');
			  profileLink.href = '/profil';
			  profileLink.innerHTML = `
				<img src="/images/profil-icon.png" alt="Profil" class="h-8 w-8 rounded-full object-cover" />
			  `;
			  profileLink.className = "inline-block"; // styling léger
	  
			  const loginButton = document.querySelector('a[href="/login"]');
			  if (loginButton) {
				loginButton.replaceWith(profileLink);
			  }
			}
		  } catch (error) {
			console.error('Erreur lors de la vérification du login', error);
		  }
		});
	  </script>
	  
	<body>
		<slot />
	</body>
</html>